# VidFab Scripts è„šæœ¬è¯´æ˜

## ğŸ“‹ å¯ç”¨è„šæœ¬

### ğŸš€ å¼€å‘ç¯å¢ƒ
- `./scripts/dev.sh` - **ç»Ÿä¸€å¼€å‘ç¯å¢ƒå¯åŠ¨** (æ¨è)
  - è‡ªåŠ¨å¯åŠ¨ Redis + é˜Ÿåˆ—ç³»ç»Ÿ + Next.js å¼€å‘æœåŠ¡å™¨
  - ä¸€é”®å¯åŠ¨å®Œæ•´å¼€å‘ç¯å¢ƒ
  - ä¼˜é›…å…³é—­æ‰€æœ‰æœåŠ¡ (Ctrl+C)
  - å¸¦å½©è‰²æ—¥å¿—è¾“å‡ºå’Œè¿›ç¨‹ç®¡ç†

### ğŸ”§ ç‹¬ç«‹æœåŠ¡å¯åŠ¨ (å¯é€‰)
å¦‚éœ€å•ç‹¬å¯åŠ¨æŸä¸ªæœåŠ¡ï¼Œå¯ä½¿ç”¨ä»¥ä¸‹è„šæœ¬ï¼š
- `./scripts/redis-start.sh` - å•ç‹¬å¯åŠ¨ Redis
- `./scripts/redis-stop.sh` - åœæ­¢ Redis

### ğŸ¥ Worker ç®¡ç†ï¼ˆPM2ï¼Œæ¨èï¼‰ â­
- `./scripts/pm2-worker.sh start` - å¯åŠ¨ Workerï¼ˆè‡ªåŠ¨é‡å¯ã€å´©æºƒæ¢å¤ï¼‰
- `./scripts/pm2-worker.sh status` - æŸ¥çœ‹ Worker çŠ¶æ€
- `./scripts/pm2-worker.sh logs` - æŸ¥çœ‹ Worker æ—¥å¿—
- `./scripts/pm2-worker.sh restart` - é‡å¯ Worker
- `./scripts/pm2-worker.sh stop` - åœæ­¢ Worker
- `./scripts/verify-worker-health.sh` - ä¸€é”®éªŒè¯ Worker å¥åº·çŠ¶æ€

**ä¼˜åŠ¿**ï¼š
- âœ… è‡ªåŠ¨é‡å¯ï¼ˆå´©æºƒå 1 ç§’æ¢å¤ï¼‰
- âœ… å†…å­˜ç›‘æ§ï¼ˆè¶…è¿‡ 512MB è‡ªåŠ¨é‡å¯ï¼‰
- âœ… å¥åº·æ£€æŸ¥å®ˆæŠ¤è¿›ç¨‹ï¼ˆæ¯ 5 åˆ†é’Ÿæ£€æµ‹åƒµå°¸ä»»åŠ¡ï¼‰
- âœ… æ—¥å¿—è‡ªåŠ¨ç®¡ç†

**å¿«é€Ÿå¯åŠ¨**ï¼š
```bash
# å®‰è£… PM2ï¼ˆä»…ç¬¬ä¸€æ¬¡ï¼‰
npm install -g pm2

# å¯åŠ¨ Worker
./scripts/pm2-worker.sh start

# éªŒè¯å¥åº·çŠ¶æ€
./scripts/verify-worker-health.sh
```

**ç›¸å…³æ–‡æ¡£**ï¼š
- [æ²»æ ¹æ–¹æ¡ˆå®Œæ•´æ–‡æ¡£](../docs/video-agent-reliability-solution.md)
- [PM2 å¿«é€Ÿå¯åŠ¨æŒ‡å—](../docs/quick-start-pm2-worker.md)

### ğŸ—ï¸ æ„å»ºå’Œéƒ¨ç½²
- `./scripts/build.sh` - æ„å»ºç”Ÿäº§ç‰ˆæœ¬
- `./scripts/start.sh` - å¯åŠ¨ç”Ÿäº§æœåŠ¡å™¨
- `./scripts/lint.sh` - è¿è¡Œä»£ç æ£€æŸ¥

### ğŸ› ï¸ ç»´æŠ¤ç›¸å…³
- `./scripts/install.sh` - å®‰è£…ä¾èµ–åŒ…
- `./scripts/clean.sh` - æ¸…ç†æ„å»ºäº§ç‰©
- `./scripts/clean.sh --full` - å®Œå…¨æ¸…ç†ï¼ˆåŒ…æ‹¬node_modulesï¼‰

### ğŸ“Š æ•°æ®åº“ç®¡ç†
- `./scripts/setup-database.sh` - åˆå§‹åŒ–æ•°æ®åº“
- `./scripts/migrate-database.sh` - è¿è¡Œæ•°æ®åº“è¿ç§»
- `./scripts/seed-database.sh` - å¡«å……æµ‹è¯•æ•°æ®

## ğŸš€ å¿«é€Ÿå¼€å§‹

### ä¸€é”®å¯åŠ¨å¼€å‘ç¯å¢ƒ
```bash
# å¯åŠ¨å®Œæ•´å¼€å‘ç¯å¢ƒï¼ˆRedis + é˜Ÿåˆ— + Next.jsï¼‰
./scripts/dev.sh
```

å¯åŠ¨åä½ å°†çœ‹åˆ°ï¼š
- ğŸŒ Next.js åº”ç”¨: http://localhost:3000
- ğŸ”— Redis: localhost:6379
- âš¡ é˜Ÿåˆ—å·¥ä½œè¿›ç¨‹åœ¨åå°è¿è¡Œ
- ğŸ“ æ‰€æœ‰æ—¥å¿—è‡ªåŠ¨è®°å½•åˆ° `logs/` ç›®å½•

### åˆ†æ­¥å¯åŠ¨ï¼ˆå¯é€‰ï¼‰
```bash
# 1. å…ˆå¯åŠ¨ Redis
./scripts/redis-start.sh

# 2. ç„¶åå¯åŠ¨å¼€å‘æœåŠ¡å™¨ï¼ˆåŒ…å«é˜Ÿåˆ—ï¼‰
./scripts/dev.sh
```

### æ„å»ºå’Œéƒ¨ç½²
```bash
# æ„å»ºé¡¹ç›®
./scripts/build.sh

# å¯åŠ¨ç”Ÿäº§æœåŠ¡å™¨
./scripts/start.sh
```

## ğŸ“ æ—¥å¿—è®°å½•

æ‰€æœ‰è„šæœ¬éƒ½ä¼šè‡ªåŠ¨è®°å½•æ—¥å¿—åˆ° `logs/` ç›®å½•ï¼š
- **æ ¼å¼**: `æœåŠ¡åç§°-YYYY-MM-DD_HH-MM-SS.log`
- **ç»Ÿä¸€å¼€å‘ç¯å¢ƒæ—¥å¿—**:
  - `nextjs-dev-[timestamp].log` - Next.js å¼€å‘æœåŠ¡å™¨æ—¥å¿—
  - `queue-worker-[timestamp].log` - é˜Ÿåˆ—å·¥ä½œè¿›ç¨‹æ—¥å¿—
- **è¿›ç¨‹è·Ÿè¸ª**: æ‰€æœ‰è¿›ç¨‹ PID ä¿å­˜åœ¨ `logs/` ç›®å½•

### æŸ¥çœ‹å®æ—¶æ—¥å¿—
```bash
# æŸ¥çœ‹ Next.js æ—¥å¿—
tail -f logs/nextjs-dev-*.log

# æŸ¥çœ‹é˜Ÿåˆ—å·¥ä½œè¿›ç¨‹æ—¥å¿—
tail -f logs/queue-worker-*.log

# Redis æ—¥å¿—
docker logs vidfab-redis -f
```

## ğŸ”§ ä½¿ç”¨è§„èŒƒ

æ ¹æ®é¡¹ç›®è§„èŒƒï¼Œ**æ‰€æœ‰è¿è¡Œå’Œè°ƒè¯•æ“ä½œéƒ½å¿…é¡»ä½¿ç”¨scriptsç›®å½•ä¸‹çš„.shè„šæœ¬**ï¼Œç¦æ­¢ç›´æ¥ä½¿ç”¨ `npm`ã€`pnpm` ç­‰å‘½ä»¤ã€‚

## ğŸ›‘ åœæ­¢æœåŠ¡

- **ç»Ÿä¸€å¼€å‘ç¯å¢ƒ**: ä½¿ç”¨ `Ctrl+C` ä¼˜é›…åœæ­¢æ‰€æœ‰æœåŠ¡
- **å•ç‹¬æœåŠ¡**: ä½¿ç”¨å„è‡ªçš„åœæ­¢è„šæœ¬

## ğŸ’¡ å¼€å‘å»ºè®®

1. **æ¨èä½¿ç”¨ç»Ÿä¸€å¯åŠ¨**: `./scripts/dev.sh` ä¸€é”®å¯åŠ¨æ‰€æœ‰å¿…è¦æœåŠ¡
2. **æŸ¥çœ‹æ—¥å¿—**: é‡åˆ°é—®é¢˜æ—¶æ£€æŸ¥ `logs/` ç›®å½•ä¸‹çš„ç›¸åº”æ—¥å¿—æ–‡ä»¶
3. **Redis ç®¡ç†**: ä½¿ç”¨ `docker exec -it vidfab-redis redis-cli` è¿›å…¥ Redis å‘½ä»¤è¡Œ
4. **æœåŠ¡çŠ¶æ€**: ä½¿ç”¨ `docker ps` æŸ¥çœ‹ Redis å®¹å™¨çŠ¶æ€