
> my-v0-project@0.1.0 dev /Users/jacob/Desktop/vidfab
> next dev

   ‚ñ≤ Next.js 15.2.4
   - Local:        http://localhost:3000
   - Network:      http://192.168.10.24:3000
   - Environments: .env.local

 ‚úì Starting...
 ‚úì Ready in 1739ms
 ‚úì Compiled /middleware in 417ms (333 modules)
[33m[auth][warn][debug-enabled][0m Read more: https://warnings.authjs.dev#debug-enabled
 ‚óã Compiling / ...
 ‚úì Compiled / in 3.2s (1778 modules)
 GET / 200 in 3675ms
 ‚úì Compiled in 529ms (875 modules)
 ‚óã Compiling /api/auth/[...nextauth] ...
 ‚úì Compiled /api/auth/[...nextauth] in 1118ms (1967 modules)
[33m[auth][warn][debug-enabled][0m Read more: https://warnings.authjs.dev#debug-enabled
 GET /api/auth/session 200 in 1673ms
 GET / 200 in 223ms
 GET /api/auth/session 200 in 17ms
 ‚úì Compiled in 627ms (876 modules)
 GET / 200 in 33ms
 ‚úì Compiled in 248ms (876 modules)
 GET / 200 in 19ms
 ‚úì Compiled in 475ms (876 modules)
 GET / 200 in 23ms
 ‚úì Compiled in 244ms (876 modules)
 GET / 200 in 20ms
 ‚óã Compiling /_not-found ...
 ‚úì Compiled /_not-found in 1201ms (1769 modules)
 GET /.well-known/appspecific/com.chrome.devtools.json 404 in 1443ms
 ‚óã Compiling /login ...
 ‚úì Compiled /login in 1749ms (1804 modules)
 GET /login 200 in 1924ms
 ‚úì Compiled /api/auth/[...nextauth] in 172ms (1125 modules)
[33m[auth][warn][debug-enabled][0m Read more: https://warnings.authjs.dev#debug-enabled
 GET /api/auth/providers 200 in 298ms
 GET /api/auth/csrf 200 in 9ms
[90m[auth][debug]:[0m CREATE_PKCECODEVERIFIER {
  "value": "NFZ50hnBCg7k0vtNF-ZRpCghKCp8vFqHCqRY52uLKOo",
  "maxAge": 900
}
[90m[auth][debug]:[0m authorization url is ready {
  "url": "https://accounts.google.com/o/oauth2/v2/auth?response_type=code&client_id=827684711935-so1rhvk9iu5a86f9ko0bik020v8v9jgn.apps.googleusercontent.com&redirect_uri=http%3A%2F%2Flocalhost%3A3000%2Fapi%2Fauth%2Fcallback%2Fgoogle&code_challenge=AzwYdTSmr1Od2zZZt68EDAwn_Sxb3OAeBcv150gihpo&code_challenge_method=S256&scope=openid+profile+email",
  "cookies": [
    {
      "name": "authjs.pkce.code_verifier",
      "value": "eyJhbGciOiJkaXIiLCJlbmMiOiJBMjU2Q0JDLUhTNTEyIiwia2lkIjoiemNwQkJUdlhaWXZ1S1E2VkxIXzN2cDBoSVR6aEZkVVdSRnpuQURtbzl0bi13VUlfYXhQOU1wcGFYS0tLeEdyVXAzU3RNM2JnQUFEWmg3T2RNMlNmNlEifQ..lEPPJvlU75UQexQdDPl9yQ.bUL0TyWBkZP-QzA2LXxqfOIyaj1zUrN5n88dnn33wUHFBhkM3b-fr4vH2ywl29-NsESoGvbSRdCZDGTalFzYop7CRPrNwIFq9HlKiLTNiNvKV9N2KQIeCZeATwizOkoUhczs42uYEb5YVeb1e70Uj2EEbyxSU-YTPwRNJ21lbimBf1Vud3Daa7-M1TzcAjPh.jvwRjjSnjxV6OH9r9UepGIwjPPUN_JWcfxMZC0PG0Uc",
      "options": {
        "httpOnly": true,
        "sameSite": "lax",
        "path": "/",
        "secure": false,
        "maxAge": 900,
        "expires": "2025-09-22T02:31:03.754Z"
      }
    }
  ],
  "provider": {
    "id": "google",
    "name": "Google",
    "type": "oidc",
    "issuer": "https://accounts.google.com",
    "style": {
      "brandColor": "#1a73e8"
    },
    "clientId": "827684711935-so1rhvk9iu5a86f9ko0bik020v8v9jgn.apps.googleusercontent.com",
    "clientSecret": "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",
    "signinUrl": "http://localhost:3000/api/auth/signin/google",
    "callbackUrl": "http://localhost:3000/api/auth/callback/google",
    "wellKnown": "https://accounts.google.com/.well-known/openid-configuration",
    "checks": [
      "pkce"
    ]
  }
}
 POST /api/auth/signin/google? 200 in 279ms
 GET /login 200 in 148ms
 GET /.well-known/appspecific/com.chrome.devtools.json 404 in 43ms
 GET /api/auth/session 200 in 21ms
 ‚óã Compiling /api/auth/send-verification-code ...
 ‚úì Compiled /api/auth/send-verification-code in 956ms (2066 modules)
‚úÖ Verification code generated for ithermocraft@hotmail.com
üìß Sending verification code 985280 to ithermocraft@hotmail.com
üîê Development Mode - Verification code for ithermocraft@hotmail.com: 985280
üîç Testing SMTP connection...
‚úÖ SMTP connection verified
üìß Sending email to ithermocraft@hotmail.com...
‚úÖ Email sent successfully: {
  messageId: '<9a0917f0-7a37-c897-6203-24f0785c78a1@vidfab.ai>',
  to: 'ithermocraft@hotmail.com',
  subject: 'VidFab - Your Verification Code: 985280'
}
‚úÖ Verification email sent successfully to ithermocraft@hotmail.com { messageId: '<9a0917f0-7a37-c897-6203-24f0785c78a1@vidfab.ai>' }
 POST /api/auth/send-verification-code 200 in 9156ms
 ‚úì Compiled /api/auth/verify-code-login in 457ms (2068 modules)
 POST /api/auth/verify-code-login 400 in 3803ms
‚úÖ Verification code verified for ithermocraft@hotmail.com
 POST /api/auth/verify-code-login 200 in 2573ms
[33m[auth][warn][debug-enabled][0m Read more: https://warnings.authjs.dev#debug-enabled
 GET /api/auth/providers 200 in 77ms
 GET /api/auth/csrf 200 in 7ms
‚úÖ User saved: ithermocraft@hotmail.com (0ac2777c-ed4b-426f-901c-790974fe9d62)
‚úÖ User signed in: ithermocraft@hotmail.com via verification-code
 POST /api/auth/callback/verification-code? 200 in 545ms
 GET /api/auth/session 200 in 10ms
 GET / 200 in 54ms
 ‚óã Compiling /create ...
 ‚úì Compiled /create in 2.4s (2328 modules)
 GET /create 200 in 2526ms
 GET /create?tool=discover 200 in 21ms
 GET /create?tool=discover 200 in 17ms
 GET /create?tool=text-to-video 200 in 47ms
 GET /create?tool=image-to-video 200 in 18ms
 GET /create?tool=video-effects 200 in 9ms
 ‚óã Compiling /api/images/upload ...
 ‚úì Compiled /api/images/upload in 2.4s (2332 modules)
Error: Route "/api/images/upload" used `headers().get('x-forwarded-proto')`. `headers()` should be awaited before using its value. Learn more: https://nextjs.org/docs/messages/sync-dynamic-apis
    at POST (app/api/images/upload/route.ts:17:30)
  15 |
  16 |     // Verify user authentication - Next.js 15 compatible
> 17 |     const session = await auth()
     |                              ^
  18 |     if (!session?.user?.uuid) {
  19 |       return NextResponse.json(
  20 |         { error: 'Unauthorized access' },
Error: Route "/api/images/upload" used `headers().get('cookie')`. `headers()` should be awaited before using its value. Learn more: https://nextjs.org/docs/messages/sync-dynamic-apis
    at POST (app/api/images/upload/route.ts:17:30)
  15 |
  16 |     // Verify user authentication - Next.js 15 compatible
> 17 |     const session = await auth()
     |                              ^
  18 |     if (!session?.user?.uuid) {
  19 |       return NextResponse.json(
  20 |         { error: 'Unauthorized access' },
[33m[auth][warn][debug-enabled][0m Read more: https://warnings.authjs.dev#debug-enabled
 POST /api/images/upload 200 in 3933ms
 ‚óã Compiling /api/video/effects ...
 ‚úì Compiled /api/video/effects in 1078ms (2334 modules)
Error: Route "/api/video/effects" used `headers().get('x-forwarded-proto')`. `headers()` should be awaited before using its value. Learn more: https://nextjs.org/docs/messages/sync-dynamic-apis
    at POST (app/api/video/effects/route.ts:32:30)
  30 |
  31 |     // Verify user authentication status
> 32 |     const session = await auth()
     |                              ^
  33 |
  34 |     if (!session?.user) {
  35 |       return NextResponse.json(
Error: Route "/api/video/effects" used `headers().get('cookie')`. `headers()` should be awaited before using its value. Learn more: https://nextjs.org/docs/messages/sync-dynamic-apis
    at POST (app/api/video/effects/route.ts:32:30)
  30 |
  31 |     // Verify user authentication status
> 32 |     const session = await auth()
     |                              ^
  33 |
  34 |     if (!session?.user) {
  35 |       return NextResponse.json(
[33m[auth][warn][debug-enabled][0m Read more: https://warnings.authjs.dev#debug-enabled
üé¨ Video effects generation request: {
  effectId: 'blueprint-supreme',
  effectName: 'Blueprint Supreme',
  hasImage: true,
  userId: '0ac2777c-ed4b-426f-901c-790974fe9d62'
}
üåä Calling Wavespeed Video Effects API: {
  url: 'https://api.wavespeed.ai/api/v3/video-effects/blueprint-supreme',
  effectId: 'blueprint-supreme',
  hasImage: true
}
üåä Wavespeed Video Effects API response: {
  status: 400,
  hasRequestId: false,
  requestId: undefined,
  error: undefined
}
üåä Wavespeed Video Effects API error: Error: Wavespeed API error: 400
    at submitVideoEffectsGeneration (app/api/video/effects/route.ts:190:12)
    at async POST (app/api/video/effects/route.ts:75:30)
  188 |       }
  189 |
> 190 |       throw new Error(data.error || `Wavespeed API error: ${response.status}`)
      |            ^
  191 |     }
  192 |
  193 |     return data
‚ùå Video effects generation error: Error: Wavespeed API error: 400
    at submitVideoEffectsGeneration (app/api/video/effects/route.ts:190:12)
    at async POST (app/api/video/effects/route.ts:75:30)
  188 |       }
  189 |
> 190 |       throw new Error(data.error || `Wavespeed API error: ${response.status}`)
      |            ^
  191 |     }
  192 |
  193 |     return data
 POST /api/video/effects 500 in 2748ms
 GET /create?tool=image-to-video 200 in 68ms
Error: Route "/api/images/upload" used `headers().get('x-forwarded-proto')`. `headers()` should be awaited before using its value. Learn more: https://nextjs.org/docs/messages/sync-dynamic-apis
    at POST (app/api/images/upload/route.ts:17:30)
  15 |
  16 |     // Verify user authentication - Next.js 15 compatible
> 17 |     const session = await auth()
     |                              ^
  18 |     if (!session?.user?.uuid) {
  19 |       return NextResponse.json(
  20 |         { error: 'Unauthorized access' },
Error: Route "/api/images/upload" used `headers().get('cookie')`. `headers()` should be awaited before using its value. Learn more: https://nextjs.org/docs/messages/sync-dynamic-apis
    at POST (app/api/images/upload/route.ts:17:30)
  15 |
  16 |     // Verify user authentication - Next.js 15 compatible
> 17 |     const session = await auth()
     |                              ^
  18 |     if (!session?.user?.uuid) {
  19 |       return NextResponse.json(
  20 |         { error: 'Unauthorized access' },
 POST /api/images/upload 200 in 2136ms
 ‚óã Compiling /api/video/generate ...
 ‚úì Compiled /api/video/generate in 1105ms (2266 modules)
Error: Route "/api/video/generate" used `headers().get('x-forwarded-proto')`. `headers()` should be awaited before using its value. Learn more: https://nextjs.org/docs/messages/sync-dynamic-apis
    at POST (app/api/video/generate/route.ts:18:30)
  16 |   try {
  17 |     // È™åËØÅÁî®Êà∑ÁôªÂΩïÁä∂ÊÄÅ
> 18 |     const session = await auth()
     |                              ^
  19 |
  20 |     if (!session?.user) {
  21 |       return NextResponse.json(
Error: Route "/api/video/generate" used `headers().get('cookie')`. `headers()` should be awaited before using its value. Learn more: https://nextjs.org/docs/messages/sync-dynamic-apis
    at POST (app/api/video/generate/route.ts:18:30)
  16 |   try {
  17 |     // È™åËØÅÁî®Êà∑ÁôªÂΩïÁä∂ÊÄÅ
> 18 |     const session = await auth()
     |                              ^
  19 |
  20 |     if (!session?.user) {
  21 |       return NextResponse.json(
[33m[auth][warn][debug-enabled][0m Read more: https://warnings.authjs.dev#debug-enabled
üîç Video generation request body: {
  prompt: '"ËÆ©ÁîªÈù¢Âä®Ëµ∑Êù•..."',
  promptLength: 6,
  model: 'vidu-q1',
  resolution: '480p',
  duration: 5,
  aspectRatio: '16:9',
  hasImage: true,
  imageType: 'provided'
}
üé¨ User ithermocraft@hotmail.com requesting video generation: {
  prompt: 'ËÆ©ÁîªÈù¢Âä®Ëµ∑Êù•...',
  model: 'vidu-q1',
  resolution: '480p',
  duration: 5,
  generationType: 'image-to-video',
  hasImage: true
}
üöÄ Submitting image-to-video request to bytedance (seedance-v1-pro-i2v-480p): {
  endpoint: '/bytedance/seedance-v1-pro-i2v-480p',
  prompt: 'ËÆ©ÁîªÈù¢Âä®Ëµ∑Êù•',
  duration: 5,
  camera_fixed: false,
  seed: -1,
  image: '[IMAGE_URL: https://ycahbhhuzgixfrljtqmi.supabase.co/storage/v...]'
}
‚úÖ image-to-video generation submitted successfully. Request ID: 8ad077000ab34088b25223564fec8271
 POST /api/video/generate 200 in 2183ms
 ‚úì Compiled /api/video/status/[requestId] in 443ms (2268 modules)
üîç Checking status for request 8ad077000ab34088b25223564fec8271
üìä Status check for 8ad077000ab34088b25223564fec8271: { status: 'created', progress: undefined, hasOutputs: false }
üìä Status result for 8ad077000ab34088b25223564fec8271: {
  status: 'created',
  progress: 0,
  hasResult: false,
  outputs: [],
  outputsLength: 0
}
 GET /api/video/status/8ad077000ab34088b25223564fec8271 200 in 1418ms
üîç Checking status for request 8ad077000ab34088b25223564fec8271
üìä Status check for 8ad077000ab34088b25223564fec8271: { status: 'created', progress: undefined, hasOutputs: false }
üìä Status result for 8ad077000ab34088b25223564fec8271: {
  status: 'created',
  progress: 0,
  hasResult: false,
  outputs: [],
  outputsLength: 0
}
 GET /api/video/status/8ad077000ab34088b25223564fec8271 200 in 175ms
üîç Checking status for request 8ad077000ab34088b25223564fec8271
üìä Status check for 8ad077000ab34088b25223564fec8271: { status: 'processing', progress: undefined, hasOutputs: false }
üìä Status result for 8ad077000ab34088b25223564fec8271: {
  status: 'processing',
  progress: 0,
  hasResult: false,
  outputs: [],
  outputsLength: 0
}
 GET /api/video/status/8ad077000ab34088b25223564fec8271 200 in 175ms
üîç Checking status for request 8ad077000ab34088b25223564fec8271
üìä Status check for 8ad077000ab34088b25223564fec8271: { status: 'processing', progress: undefined, hasOutputs: false }
üìä Status result for 8ad077000ab34088b25223564fec8271: {
  status: 'processing',
  progress: 0,
  hasResult: false,
  outputs: [],
  outputsLength: 0
}
 GET /api/video/status/8ad077000ab34088b25223564fec8271 200 in 178ms
üîç Checking status for request 8ad077000ab34088b25223564fec8271
üìä Status check for 8ad077000ab34088b25223564fec8271: { status: 'processing', progress: undefined, hasOutputs: false }
üìä Status result for 8ad077000ab34088b25223564fec8271: {
  status: 'processing',
  progress: 0,
  hasResult: false,
  outputs: [],
  outputsLength: 0
}
 GET /api/video/status/8ad077000ab34088b25223564fec8271 200 in 189ms
üîç Checking status for request 8ad077000ab34088b25223564fec8271
üìä Status check for 8ad077000ab34088b25223564fec8271: { status: 'processing', progress: undefined, hasOutputs: false }
üìä Status result for 8ad077000ab34088b25223564fec8271: {
  status: 'processing',
  progress: 0,
  hasResult: false,
  outputs: [],
  outputsLength: 0
}
 GET /api/video/status/8ad077000ab34088b25223564fec8271 200 in 185ms
üîç Checking status for request 8ad077000ab34088b25223564fec8271
üìä Status check for 8ad077000ab34088b25223564fec8271: { status: 'processing', progress: undefined, hasOutputs: false }
üìä Status result for 8ad077000ab34088b25223564fec8271: {
  status: 'processing',
  progress: 0,
  hasResult: false,
  outputs: [],
  outputsLength: 0
}
 GET /api/video/status/8ad077000ab34088b25223564fec8271 200 in 177ms
üîç Checking status for request 8ad077000ab34088b25223564fec8271
üìä Status check for 8ad077000ab34088b25223564fec8271: { status: 'processing', progress: undefined, hasOutputs: false }
üìä Status result for 8ad077000ab34088b25223564fec8271: {
  status: 'processing',
  progress: 0,
  hasResult: false,
  outputs: [],
  outputsLength: 0
}
 GET /api/video/status/8ad077000ab34088b25223564fec8271 200 in 184ms
üîç Checking status for request 8ad077000ab34088b25223564fec8271
üìä Status check for 8ad077000ab34088b25223564fec8271: { status: 'processing', progress: undefined, hasOutputs: false }
üìä Status result for 8ad077000ab34088b25223564fec8271: {
  status: 'processing',
  progress: 0,
  hasResult: false,
  outputs: [],
  outputsLength: 0
}
 GET /api/video/status/8ad077000ab34088b25223564fec8271 200 in 179ms
üîç Checking status for request 8ad077000ab34088b25223564fec8271
üìä Status check for 8ad077000ab34088b25223564fec8271: { status: 'processing', progress: undefined, hasOutputs: false }
üìä Status result for 8ad077000ab34088b25223564fec8271: {
  status: 'processing',
  progress: 0,
  hasResult: false,
  outputs: [],
  outputsLength: 0
}
 GET /api/video/status/8ad077000ab34088b25223564fec8271 200 in 179ms
üîç Checking status for request 8ad077000ab34088b25223564fec8271
üìä Status check for 8ad077000ab34088b25223564fec8271: { status: 'completed', progress: undefined, hasOutputs: true }
üìä Status result for 8ad077000ab34088b25223564fec8271: {
  status: 'completed',
  progress: 0,
  hasResult: true,
  outputs: [
    'https://d1q70pf5vjeyhc.cloudfront.net/predictions/8ad077000ab34088b25223564fec8271/1.mp4'
  ],
  outputsLength: 1
}
 GET /api/video/status/8ad077000ab34088b25223564fec8271 200 in 178ms
 ‚óã Compiling /api/video/store ...
 ‚úì Compiled /api/video/store in 675ms (2272 modules)
üîÑ Internal storage call for user: 0ac2777c-ed4b-426f-901c-790974fe9d62
üé¨ Starting internal video storage for user: 0ac2777c-ed4b-426f-901c-790974fe9d62 {
  wavespeedRequestId: '8ad077000ab34088b25223564fec8271',
  originalUrl: 'https://d1q70pf5vjeyhc.cloudfront.net/predictions/8ad077000ab34088b25223564fec8271/1.mp4...',
  settings: {
    model: 'vidu-q1',
    duration: '5',
    resolution: '480p',
    aspectRatio: '16:9',
    seed: -1,
    generationType: 'image-to-video',
    prompt: 'ËÆ©ÁîªÈù¢Âä®Ëµ∑Êù•'
  }
}
üë§ Force creating/updating user record: 0ac2777c-ed4b-426f-901c-790974fe9d62
‚úÖ User already exists: 0ac2777c-ed4b-426f-901c-790974fe9d62
‚úÖ User record verified: 0ac2777c-ed4b-426f-901c-790974fe9d62
Error creating video: {
  code: '23503',
  details: 'Key (user_id)=(0ac2777c-ed4b-426f-901c-790974fe9d62) is not present in table "users".',
  hint: null,
  message: 'insert or update on table "user_videos" violates foreign key constraint "user_videos_user_id_fkey"'
}
[UserVideosDB.createVideo] {
  code: '23503',
  details: 'Key (user_id)=(0ac2777c-ed4b-426f-901c-790974fe9d62) is not present in table "users".',
  hint: null,
  message: 'insert or update on table "user_videos" violates foreign key constraint "user_videos_user_id_fkey"'
}
Supabase error: {
  code: '23503',
  details: 'Key (user_id)=(0ac2777c-ed4b-426f-901c-790974fe9d62) is not present in table "users".',
  hint: null,
  message: 'insert or update on table "user_videos" violates foreign key constraint "user_videos_user_id_fkey"'
}
Failed to create video record: Error: insert or update on table "user_videos" violates foreign key constraint "user_videos_user_id_fkey"
    at handleSupabaseError (lib/supabase.ts:174:10)
    at eval (lib/database/user-videos.ts:46:30)
    at async retryWithBackoff (lib/utils/error-handling.ts:58:21)
    at async processVideoStorage (app/api/video/store/route.ts:203:21)
    at async POST (app/api/video/store/route.ts:37:13)
  172 |   
  173 |   if (error?.message) {
> 174 |     throw new Error(error.message);
      |          ^
  175 |   }
  176 |   
  177 |   throw new Error('Database operation failed');
 POST /api/video/store 200 in 4450ms
 GET /create?tool=my-assets 200 in 65ms
 GET /create?tool=my-assets 200 in 228ms
 ‚úì Compiled /_not-found in 485ms (2276 modules)
 GET /.well-known/appspecific/com.chrome.devtools.json 404 in 582ms
 ‚óã Compiling /api/auth/[...nextauth] ...
 ‚úì Compiled /api/auth/[...nextauth] in 582ms (1271 modules)
[33m[auth][warn][debug-enabled][0m Read more: https://warnings.authjs.dev#debug-enabled
 GET /api/auth/session 200 in 651ms
 ‚úì Compiled in 958ms (1018 modules)
 GET /create?tool=my-assets 200 in 60ms
 ‚úì Compiled in 508ms (1018 modules)
 GET /create?tool=my-assets 200 in 46ms
 ‚úì Compiled in 401ms (1018 modules)
 GET /create?tool=my-assets 200 in 20ms
 ‚úì Compiled in 251ms (1018 modules)
 GET /create?tool=my-assets 200 in 15ms
 ‚úì Compiled in 194ms (1018 modules)
 GET /create?tool=my-assets 200 in 20ms
