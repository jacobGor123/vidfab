# åˆ†å­—æ®µç¼–è¾‘ UI è®¾è®¡æ–¹æ¡ˆ

## ğŸ“‹ è®¾è®¡ç›®æ ‡

1. âœ… è®©ç”¨æˆ·æ¸…æ¥šçŸ¥é“æ¯ä¸ªå­—æ®µçš„ä½œç”¨
2. âœ… ä¿ç•™æ‰€æœ‰è‡ªåŠ¨ç”Ÿæˆçš„çº¦æŸï¼ˆè§’è‰²ä¸€è‡´æ€§ã€é£æ ¼ã€è´¨é‡ç­‰ï¼‰
3. âœ… æä¾›å®Œæ•´ Prompt é¢„è§ˆåŠŸèƒ½
4. âœ… æå‡ç”¨æˆ·ä½“éªŒï¼Œé¿å…æ··æ·†

---

## ğŸ¨ UI è®¾è®¡æ–¹æ¡ˆ

### æ–¹æ¡ˆ 1ï¼šæŠ˜å å¼å¤šå­—æ®µç¼–è¾‘ï¼ˆæ¨èï¼‰

**å¸ƒå±€ç¤ºä¾‹**ï¼š

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ Shot 1                            ğŸ”„ â–¶  â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚  [åˆ†é•œå›¾/è§†é¢‘æ˜¾ç¤ºåŒºåŸŸ]                    â”‚
â”‚                                         â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚  â–¼ Edit Scene Details                  â”‚  â† ç‚¹å‡»å±•å¼€/æ”¶èµ·
â”‚                                         â”‚
â”‚  Scene Description *                    â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚
â”‚  â”‚ A cozy coffee shop with warm      â”‚ â”‚
â”‚  â”‚ lighting                          â”‚ â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚
â”‚                                         â”‚
â”‚  Camera Angle                           â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚
â”‚  â”‚ Wide shot                         â”‚ â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚
â”‚                                         â”‚
â”‚  Character Action *                     â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚
â”‚  â”‚ Angela walks in and greets the    â”‚ â”‚
â”‚  â”‚ barista                           â”‚ â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚
â”‚                                         â”‚
â”‚  Mood/Atmosphere                        â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚
â”‚  â”‚ Warm and welcoming                â”‚ â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚
â”‚                                         â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚
â”‚  â”‚ Preview Prompt  â”‚  â”‚ Reset        â”‚ â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚
â”‚                                         â”‚
â”‚  ğŸ’¡ Auto-added: Character consistency, â”‚
â”‚     style, quality constraints          â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

**ç‰¹ç‚¹**ï¼š
- âœ… æ¯ä¸ªå­—æ®µæœ‰æ˜ç¡®çš„æ ‡ç­¾
- âœ… å¿…å¡«å­—æ®µæ ‡è®° *
- âœ… "Preview Prompt" æŒ‰é’®å¯æŸ¥çœ‹å®Œæ•´ prompt
- âœ… "Reset" æŒ‰é’®æ¢å¤é»˜è®¤å€¼
- âœ… æç¤ºè‡ªåŠ¨æ·»åŠ çš„å†…å®¹

---

### æ–¹æ¡ˆ 2ï¼šæ ‡ç­¾é¡µå¼ç¼–è¾‘ï¼ˆé€‚åˆå­—æ®µæ›´å¤šçš„æƒ…å†µï¼‰

**å¸ƒå±€ç¤ºä¾‹**ï¼š

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ Shot 1                            ğŸ”„ â–¶  â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚  [åˆ†é•œå›¾/è§†é¢‘æ˜¾ç¤ºåŒºåŸŸ]                    â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚  â”Œâ”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚  â”‚Basicâ”‚Cameraâ”‚Actionâ”‚Moodâ”‚Advanced â”‚   â”‚ â† æ ‡ç­¾é¡µ
â”‚  â””â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â”‚                                         â”‚
â”‚  Basic Tab:                             â”‚
â”‚  Scene Description *                    â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚
â”‚  â”‚ A cozy coffee shop...             â”‚ â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚
â”‚                                         â”‚
â”‚  [Preview Full Prompt]                  â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

**ç‰¹ç‚¹**ï¼š
- âœ… æ›´é€‚åˆå­—æ®µè¾ƒå¤šæ—¶
- âœ… å¯ä»¥åˆ†ç»„ï¼ˆåŸºç¡€ã€é•œå¤´ã€åŠ¨ä½œç­‰ï¼‰
- âš ï¸ å¯èƒ½è¿‡åº¦è®¾è®¡ï¼ˆå½“å‰å­—æ®µä¸å¤šï¼‰

---

### æ–¹æ¡ˆ 3ï¼šå†…è”å¼è½»é‡ç¼–è¾‘ï¼ˆæœ€ç®€å•ï¼‰

**å¸ƒå±€ç¤ºä¾‹**ï¼š

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ Shot 1                            ğŸ”„ â–¶  â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚  [åˆ†é•œå›¾/è§†é¢‘æ˜¾ç¤ºåŒºåŸŸ]                    â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚  â–¼ Edit Fields                          â”‚
â”‚                                         â”‚
â”‚  ğŸ“ Scene: [A cozy coffee shop...]      â”‚
â”‚  ğŸ¥ Camera: [Wide shot]                 â”‚
â”‚  ğŸ¬ Action: [Angela walks in...]        â”‚
â”‚  ğŸ­ Mood: [Warm and welcoming]          â”‚
â”‚                                         â”‚
â”‚  [Preview] [Reset] [Regenerate]         â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

**ç‰¹ç‚¹**ï¼š
- âœ… æœ€ç®€æ´
- âœ… æ”¹åŠ¨æœ€å°
- âš ï¸ è¾“å…¥æ¡†è¾ƒå°ï¼Œä¸é€‚åˆé•¿æ–‡æœ¬

---

## ğŸ¯ æ¨èæ–¹æ¡ˆï¼šæ–¹æ¡ˆ 1ï¼ˆæŠ˜å å¼å¤šå­—æ®µç¼–è¾‘ï¼‰

### è¯¦ç»†è®¾è®¡

#### åˆ†é•œå›¾ç¼–è¾‘ï¼ˆStep 3ï¼‰

**å­—æ®µå®šä¹‰**ï¼š
```typescript
interface StoryboardEditFields {
  description: string      // åœºæ™¯æè¿°ï¼ˆå¿…å¡«ï¼‰
  camera_angle: string     // é•œå¤´è§’åº¦ï¼ˆå¯é€‰ï¼Œæœ‰é»˜è®¤å€¼ï¼‰
  character_action: string // è§’è‰²åŠ¨ä½œï¼ˆå¿…å¡«ï¼‰
  mood: string            // æƒ…ç»ªæ°›å›´ï¼ˆå¯é€‰ï¼Œæœ‰é»˜è®¤å€¼ï¼‰
}
```

**UI ç»„ä»¶å±‚æ¬¡**ï¼š
```
Step3StoryboardCard
  â””â”€ StoryboardFieldsEditor (æ–°å¢)
      â”œâ”€ FieldInput (description)
      â”œâ”€ FieldInput (camera_angle)
      â”œâ”€ FieldInput (character_action)
      â”œâ”€ FieldInput (mood)
      â”œâ”€ PromptPreviewDialog (æ–°å¢)
      â””â”€ Actions (Preview, Reset, Regenerate)
```

#### è§†é¢‘ç¼–è¾‘ï¼ˆStep 4ï¼‰

**å­—æ®µå®šä¹‰**ï¼š
```typescript
interface VideoEditFields {
  description: string      // åœºæ™¯æè¿°ï¼ˆå¿…å¡«ï¼‰
  character_action: string // è§’è‰²åŠ¨ä½œï¼ˆå¿…å¡«ï¼‰
  // å…¶ä»–å­—æ®µç”±ç³»ç»Ÿè‡ªåŠ¨æ·»åŠ ï¼š
  // - è§’è‰²ä¸€è‡´æ€§çº¦æŸï¼ˆBytePlus æ¨¡å¼ï¼‰
  // - ç¦æ­¢å­—å¹•æŒ‡ä»¤ï¼ˆæ‰€æœ‰æ¨¡å¼ï¼‰
}
```

**UI ç»„ä»¶å±‚æ¬¡**ï¼š
```
Step4VideoCard
  â””â”€ VideoFieldsEditor (æ–°å¢)
      â”œâ”€ FieldInput (description)
      â”œâ”€ FieldInput (character_action)
      â”œâ”€ PromptPreviewDialog (æ–°å¢)
      â””â”€ Actions (Preview, Reset, Regenerate)
```

---

## ğŸ”§ å®ç°æ–¹æ¡ˆ

### å‰ç«¯å®ç°

#### 1. åˆ›å»ºé€šç”¨å­—æ®µç¼–è¾‘ç»„ä»¶

**æ–‡ä»¶**: `components/studio/video-agent-beta/components/common/FieldsEditor.tsx`

```typescript
interface Field {
  name: string
  label: string
  value: string
  placeholder: string
  required?: boolean
  rows?: number
  maxLength?: number
  helpText?: string
}

interface FieldsEditorProps {
  fields: Field[]
  onChange: (name: string, value: string) => void
  onReset: () => void
  onPreview: () => void
  autoAddedInfo?: string
}

export function FieldsEditor({
  fields,
  onChange,
  onReset,
  onPreview,
  autoAddedInfo
}: FieldsEditorProps) {
  return (
    <div className="space-y-3 pt-2 border-t">
      {fields.map(field => (
        <div key={field.name} className="space-y-1">
          <label className="text-xs font-medium text-muted-foreground">
            {field.label}
            {field.required && <span className="text-red-400 ml-1">*</span>}
          </label>
          <textarea
            value={field.value}
            onChange={(e) => onChange(field.name, e.target.value)}
            placeholder={field.placeholder}
            rows={field.rows || 2}
            maxLength={field.maxLength}
            className="w-full text-xs p-2 bg-muted/50 border border-muted rounded resize-none focus:outline-none focus:border-primary"
          />
          {field.helpText && (
            <p className="text-xs text-muted-foreground/60">{field.helpText}</p>
          )}
        </div>
      ))}

      {autoAddedInfo && (
        <div className="p-2 bg-primary/5 border border-primary/10 rounded text-xs text-muted-foreground">
          ğŸ’¡ {autoAddedInfo}
        </div>
      )}

      <div className="flex gap-2 pt-2">
        <button
          onClick={onPreview}
          className="flex-1 text-xs px-3 py-1.5 bg-primary/10 hover:bg-primary/20 text-primary rounded transition-colors"
        >
          Preview Full Prompt
        </button>
        <button
          onClick={onReset}
          className="text-xs px-3 py-1.5 bg-muted/30 hover:bg-muted/60 text-muted-foreground rounded transition-colors"
        >
          Reset
        </button>
      </div>
    </div>
  )
}
```

#### 2. åˆ›å»º Prompt é¢„è§ˆå¯¹è¯æ¡†

**æ–‡ä»¶**: `components/studio/video-agent-beta/components/common/PromptPreviewDialog.tsx`

```typescript
interface PromptPreviewDialogProps {
  open: boolean
  onOpenChange: (open: boolean) => void
  fullPrompt: string
  shotNumber: number
}

export function PromptPreviewDialog({
  open,
  onOpenChange,
  fullPrompt,
  shotNumber
}: PromptPreviewDialogProps) {
  return (
    <Dialog open={open} onOpenChange={onOpenChange}>
      <DialogContent className="max-w-2xl">
        <DialogHeader>
          <DialogTitle>Full Prompt Preview - Shot {shotNumber}</DialogTitle>
          <DialogDescription>
            This is the complete prompt that will be sent to the AI model
          </DialogDescription>
        </DialogHeader>

        <div className="space-y-4">
          {/* å®Œæ•´ Prompt æ˜¾ç¤º */}
          <div className="max-h-[60vh] overflow-y-auto">
            <pre className="text-xs p-4 bg-muted/50 rounded whitespace-pre-wrap font-mono">
              {fullPrompt}
            </pre>
          </div>

          {/* å­—æ•°ç»Ÿè®¡ */}
          <div className="text-xs text-muted-foreground">
            Total characters: {fullPrompt.length}
          </div>

          {/* å…³é”®éƒ¨åˆ†é«˜äº®è¯´æ˜ */}
          <div className="text-xs space-y-2 p-3 bg-primary/5 rounded">
            <div className="font-medium">This prompt includes:</div>
            <ul className="space-y-1 list-disc list-inside text-muted-foreground">
              <li>Your custom scene description</li>
              <li>Character consistency constraints</li>
              <li>Camera angle and character actions</li>
              <li>Style and quality requirements</li>
              <li>Automatic safety filters</li>
            </ul>
          </div>
        </div>

        <DialogFooter>
          <button
            onClick={() => onOpenChange(false)}
            className="px-4 py-2 bg-primary text-primary-foreground rounded hover:bg-primary/90"
          >
            Close
          </button>
        </DialogFooter>
      </DialogContent>
    </Dialog>
  )
}
```

#### 3. é›†æˆåˆ°åˆ†é•œå›¾å¡ç‰‡

**ä¿®æ”¹æ–‡ä»¶**: `Step3StoryboardCard.tsx`

```typescript
// çŠ¶æ€ç®¡ç†
const [editFields, setEditFields] = useState<{
  description: string
  camera_angle: string
  character_action: string
  mood: string
} | null>(null)

const [showPreview, setShowPreview] = useState(false)

// è·å–é»˜è®¤å€¼
const getDefaultFields = () => {
  const shot = /* ä» project.script_analysis è·å– */
  return {
    description: shot.description,
    camera_angle: shot.camera_angle,
    character_action: shot.character_action,
    mood: shot.mood
  }
}

// æ„å»ºå®Œæ•´ Prompt ç”¨äºé¢„è§ˆ
const buildFullPrompt = (fields: typeof editFields) => {
  // è°ƒç”¨åç«¯çš„ buildStoryboardPrompt é€»è¾‘ï¼ˆæˆ–åœ¨å‰ç«¯å¤åˆ¶ä¸€ä»½ï¼‰
  // è¿”å›å®Œæ•´çš„ prompt å­—ç¬¦ä¸²
}

// å­—æ®µå®šä¹‰
const fields: Field[] = [
  {
    name: 'description',
    label: 'Scene Description',
    value: editFields?.description || '',
    placeholder: 'Describe the scene...',
    required: true,
    rows: 3,
    helpText: 'What is happening in this scene?'
  },
  {
    name: 'camera_angle',
    label: 'Camera Angle',
    value: editFields?.camera_angle || '',
    placeholder: 'e.g., Wide shot, Close-up, Over-the-shoulder',
    rows: 2
  },
  {
    name: 'character_action',
    label: 'Character Action',
    value: editFields?.character_action || '',
    placeholder: 'What are the characters doing?',
    required: true,
    rows: 3
  },
  {
    name: 'mood',
    label: 'Mood/Atmosphere',
    value: editFields?.mood || '',
    placeholder: 'e.g., Warm and welcoming, Tense, Mysterious',
    rows: 2
  }
]

// æ¸²æŸ“
{expandedPrompts[item.shot_number] && (
  <>
    <FieldsEditor
      fields={fields}
      onChange={(name, value) => {
        setEditFields(prev => ({ ...prev, [name]: value }))
      }}
      onReset={() => setEditFields(getDefaultFields())}
      onPreview={() => setShowPreview(true)}
      autoAddedInfo="Character consistency, style, and quality constraints will be automatically added"
    />

    <PromptPreviewDialog
      open={showPreview}
      onOpenChange={setShowPreview}
      fullPrompt={buildFullPrompt(editFields)}
      shotNumber={item.shot_number}
    />
  </>
)}
```

---

### åç«¯ API æ”¹åŠ¨

#### æ–¹æ¡ˆ Aï¼šæœ€å°æ”¹åŠ¨ï¼ˆæ¨èï¼‰

**ä¿æŒç°æœ‰ API ä¸å˜**ï¼Œå‰ç«¯å°†å¤šä¸ªå­—æ®µåˆå¹¶åå†å‘é€ï¼š

```typescript
// å‰ç«¯å‘é€æ—¶
const customPrompt = JSON.stringify({
  description: editFields.description,
  camera_angle: editFields.camera_angle,
  character_action: editFields.character_action,
  mood: editFields.mood
})

// åç«¯è§£æ
const body = await request.json()
let fields: any = null
try {
  fields = JSON.parse(body.customPrompt)
} catch {
  // å¦‚æœä¸æ˜¯ JSONï¼Œå½“ä½œæ™®é€šå­—ç¬¦ä¸²ï¼ˆå‘åå…¼å®¹ï¼‰
  fields = { description: body.customPrompt }
}

// æ„å»º Shot
const modifiedShot = {
  ...shot,
  description: fields.description || shot.description,
  camera_angle: fields.camera_angle || shot.camera_angle,
  character_action: fields.character_action || shot.character_action,
  mood: fields.mood || shot.mood
}

const prompt = buildStoryboardPrompt(modifiedShot, style, characters, hasReferenceImages)
```

**ä¼˜ç‚¹**ï¼š
- âœ… API æ¥å£ä¸éœ€è¦æ”¹åŠ¨
- âœ… å‘åå…¼å®¹ï¼ˆæ—§å®¢æˆ·ç«¯ä»å¯ä½¿ç”¨å­—ç¬¦ä¸²ï¼‰
- âœ… å®æ–½æˆæœ¬ä½

**ç¼ºç‚¹**ï¼š
- âš ï¸ ä½¿ç”¨ JSON å­—ç¬¦ä¸²ä¸å¤Ÿä¼˜é›…

---

#### æ–¹æ¡ˆ Bï¼šæ–°å¢ä¸“ç”¨ APIï¼ˆæ›´è§„èŒƒï¼‰

**æ–°å¢æ¥å£**ï¼š
```
POST /api/video-agent/projects/[id]/storyboards/[shotNumber]/regenerate-v2
```

**è¯·æ±‚ä½“**ï¼š
```typescript
{
  description?: string
  camera_angle?: string
  character_action?: string
  mood?: string
}
```

**ä¼˜ç‚¹**ï¼š
- âœ… æ›´è§„èŒƒã€æ›´æ¸…æ™°
- âœ… ç±»å‹å®‰å…¨

**ç¼ºç‚¹**ï¼š
- âŒ éœ€è¦ç»´æŠ¤ä¸¤å¥— API
- âŒ å®æ–½æˆæœ¬è¾ƒé«˜

---

## ğŸ“Š å®æ–½ä¼˜å…ˆçº§å»ºè®®

### Phase 1ï¼šæ ¸å¿ƒåŠŸèƒ½ï¼ˆ1-2 å¤©ï¼‰
1. âœ… åˆ›å»º `FieldsEditor` é€šç”¨ç»„ä»¶
2. âœ… åˆ›å»º `PromptPreviewDialog` ç»„ä»¶
3. âœ… é›†æˆåˆ°åˆ†é•œå›¾å¡ç‰‡ï¼ˆStep 3ï¼‰
4. âœ… åç«¯é‡‡ç”¨æ–¹æ¡ˆ Aï¼ˆJSON å­—ç¬¦ä¸²ï¼‰

### Phase 2ï¼šå®Œå–„åŠŸèƒ½ï¼ˆ1 å¤©ï¼‰
1. âœ… é›†æˆåˆ°è§†é¢‘å¡ç‰‡ï¼ˆStep 4ï¼‰
2. âœ… æ·»åŠ å­—æ®µéªŒè¯ï¼ˆå¿…å¡«æ£€æŸ¥ã€é•¿åº¦é™åˆ¶ï¼‰
3. âœ… æ·»åŠ "æ¢å¤é»˜è®¤"ç¡®è®¤å¯¹è¯æ¡†

### Phase 3ï¼šä¼˜åŒ–ä½“éªŒï¼ˆå¯é€‰ï¼‰
1. ğŸ”„ æ·»åŠ å­—æ®µå®æ—¶é¢„è§ˆ
2. ğŸ”„ æ·»åŠ å¸¸ç”¨æ¨¡æ¿ï¼ˆé¢„è®¾çš„ camera_angleã€mood ç­‰ï¼‰
3. ğŸ”„ æ”¯æŒæ‹–æ‹½è°ƒæ•´å­—æ®µé¡ºåº

---

## ğŸ¨ UI ç»†èŠ‚å»ºè®®

### 1. å­—æ®µæ ‡ç­¾çš„å›¾æ ‡

```tsx
const fieldIcons = {
  description: 'ğŸ“',
  camera_angle: 'ğŸ¥',
  character_action: 'ğŸ¬',
  mood: 'ğŸ­'
}
```

### 2. å­—æ®µéªŒè¯æç¤º

```tsx
{field.required && !field.value.trim() && (
  <p className="text-xs text-red-400">This field is required</p>
)}
```

### 3. å­—æ•°ç»Ÿè®¡

```tsx
<div className="text-xs text-muted-foreground text-right">
  {field.value.length} / {field.maxLength}
</div>
```

### 4. è‡ªåŠ¨ä¿å­˜æç¤º

```tsx
<div className="text-xs text-green-400">
  âœ“ Changes saved
</div>
```

---

## ğŸ”„ å‘åå…¼å®¹ç­–ç•¥

1. **ä¿ç•™æ—§çš„å•å­—æ®µè¾“å…¥æ¡†**ï¼šæ·»åŠ ä¸€ä¸ªåˆ‡æ¢å¼€å…³
   ```tsx
   <button onClick={() => setUseFieldsEditor(!useFieldsEditor)}>
     {useFieldsEditor ? 'Switch to Simple Mode' : 'Switch to Advanced Mode'}
   </button>
   ```

2. **æ¸è¿›å¼è¿ç§»**ï¼š
   - æ–°ç”¨æˆ·é»˜è®¤ä½¿ç”¨å­—æ®µç¼–è¾‘
   - è€ç”¨æˆ·å¯ä»¥é€‰æ‹©åˆ‡æ¢

---

## âœ… ä¼˜åŠ¿æ€»ç»“

1. âœ… **æ¸…æ™°é€æ˜**ï¼šç”¨æˆ·çŸ¥é“æ¯ä¸ªå­—æ®µçš„ä½œç”¨
2. âœ… **ä¸ä¸¢å¤±ä¿¡æ¯**ï¼šæ‰€æœ‰çº¦æŸéƒ½è‡ªåŠ¨ä¿ç•™
3. âœ… **çµæ´»å¯æ§**ï¼šç”¨æˆ·å¯ä»¥ç²¾ç¡®æ§åˆ¶æ¯ä¸ªéƒ¨åˆ†
4. âœ… **æ˜“äºæ‰©å±•**ï¼šæœªæ¥å¯ä»¥æ·»åŠ æ›´å¤šå­—æ®µï¼ˆlightingã€composition ç­‰ï¼‰
5. âœ… **æå‡ä¸“ä¸šæ€§**ï¼šç±»ä¼¼äºä¸“ä¸šè§†é¢‘åˆ¶ä½œè½¯ä»¶çš„ç•Œé¢

---

## ğŸ“ éœ€è¦å†³ç­–çš„ç‚¹

1. **UI æ–¹æ¡ˆé€‰æ‹©**ï¼š
   - [ ] æ–¹æ¡ˆ 1ï¼šæŠ˜å å¼å¤šå­—æ®µï¼ˆæ¨èï¼‰
   - [ ] æ–¹æ¡ˆ 2ï¼šæ ‡ç­¾é¡µå¼
   - [ ] æ–¹æ¡ˆ 3ï¼šå†…è”å¼è½»é‡

2. **åç«¯ API ç­–ç•¥**ï¼š
   - [ ] æ–¹æ¡ˆ Aï¼šJSON å­—ç¬¦ä¸²ï¼ˆå¿«é€Ÿå®æ–½ï¼‰
   - [ ] æ–¹æ¡ˆ Bï¼šæ–°å¢ä¸“ç”¨ APIï¼ˆè§„èŒƒä½†æˆæœ¬é«˜ï¼‰

3. **æ˜¯å¦ä¿ç•™ç®€å•æ¨¡å¼**ï¼š
   - [ ] æ˜¯ï¼Œæä¾›åˆ‡æ¢å¼€å…³
   - [ ] å¦ï¼Œç›´æ¥æ›¿æ¢ä¸ºå­—æ®µç¼–è¾‘

4. **å®æ–½æ—¶é—´**ï¼š
   - [ ] ç«‹å³å¼€å§‹ï¼ˆPhase 1 + 2ï¼Œçº¦ 2-3 å¤©ï¼‰
   - [ ] å»¶åï¼ˆå…ˆè§‚å¯Ÿå½“å‰æ–¹æ¡ˆ A çš„æ•ˆæœï¼‰

---

ä½ å€¾å‘äºå“ªä¸ªæ–¹æ¡ˆï¼Ÿæˆ‘å¯ä»¥ç«‹å³å¼€å§‹å®æ–½ï¼
