# 项目文件清理建议

**生成时间**: 2025-11-17
**目的**: 清理过时文档、一次性脚本和备份文件，保持项目整洁

---

## 📊 清理概览

| 类别 | 数量 | 建议操作 |
|------|------|----------|
| **已完成任务文档** | 12 个 | 归档或删除 |
| **一次性运维脚本** | 27 个 | 移至 archive/ |
| **代码备份文件** | 11 个 | 立即删除 |
| **临时报告文件** | 3 个 | 移至 archive/ |
| **临时数据文件** | 2 个 | 移至 archive/ |
| **根目录分析文档** | 2 个 | 归档 |

**总计**: 约 57 个文件需要清理

---

## 1️⃣ 已完成任务文档（discuss/ 目录）

### 🔥 轮询系统迁移相关（已完成 ✅）

**可以删除的文档**：
```bash
discuss/阶段1完成总结.md
discuss/阶段2-任务1-创建统一轮询引擎完成总结.md
discuss/阶段2-任务2-视频轮询迁移完成总结.md
discuss/阶段2完成总结.md
discuss/紧急修复-requestId状态同步问题.md
discuss/紧急修复-轮询卡住问题.md
discuss/紧急修复-错误消息国际化.md
discuss/视频轮询V2迁移完成总结.md
discuss/生产迁移计划.md
discuss/视频轮询迁移指南.md
discuss/轮询逻辑优化方案.md
```

**理由**: 轮询系统已迁移到 V2 并稳定运行，这些文档已失去参考价值。

**可以保留的文档**：
```bash
discuss/下一步优化方案.md  # 包含未来优化思路
```

---

### 💰 积分系统相关（部分可保留）

**可以移至归档的文档**：
```bash
discuss/员工积分赠送实施方案.md  # 功能已实现
```

**建议保留的文档**（作为技术参考）：
```bash
discuss/积分系统代码快速参考.md      # 开发时查阅
discuss/积分系统深度分析报告.md      # 架构参考
```

---

## 2️⃣ 一次性运维脚本（scripts/ 目录）

### 🔧 用户积分管理脚本（一次性数据修复）

**可以归档的脚本**：
```bash
scripts/add-credits-for-missing-users.ts
scripts/add-single-credit.ts
scripts/audit-missing-employees.ts
scripts/batch-check-credits.ts
scripts/batch-topup-credits.ts
scripts/check-kayee-status.ts
scripts/check-kayee-tranhom.ts
scripts/check-low-credit-users.ts
scripts/check-pending.ts
scripts/check-user-credits.ts
scripts/direct-add-credits.ts
scripts/find-all-zero-credits.ts
scripts/find-meijun-exact.ts
scripts/force-create-missing-users.ts
scripts/full-credits-audit.ts
scripts/manual-add-credits.ts
scripts/manual-create-user.ts
scripts/mark-pending-credits-claimed.ts
scripts/recent-users.ts
scripts/search-meijun.ts
```

**理由**: 这些是针对特定用户（kayee, meijun 等）的一次性数据修复脚本，已完成使命。

---

### 🔍 轮询系统调试脚本（一次性验证）

**可以归档的脚本**：
```bash
scripts/check-user-permissions.ts
scripts/debug-polling-issue.ts
scripts/verify-polling-config.ts
scripts/verify-unified-polling.ts
scripts/verify-video-polling-v2.ts
scripts/test-stuck-polling.sh
scripts/remove-debug-logs.py
```

**理由**: 轮询系统已稳定，这些验证脚本不再需要。

---

### 📊 临时报告和数据文件

**可以归档的文件**：
```bash
scripts/reports/assignment-report-1763024582815.json
scripts/reports/assignment-report-1763086746121.json
scripts/reports/employee-permissions-analysis.md

scripts/employees.json
scripts/employees_teamone_supplement.json
```

**理由**: 这些是特定时间点的数据快照，已完成使用。

---

### 🗄️ SQL 脚本（一次性迁移）

**可以归档的脚本**：
```bash
scripts/sql/create_pending_credits.sql
scripts/sql/create_pending_credits_simple.sql
scripts/sql/insert_employee_credits_template.sql
scripts/sql/query_pending_credits.sql
scripts/sql/upgrade-employee-to-pro.sql
scripts/sql/upgrade-single-user-to-pro.sql
```

**理由**: 数据库迁移和初始化脚本，已执行完成。

---

## 3️⃣ 代码备份文件（立即删除 ⚠️）

### 🚨 组件备份（应立即删除）

```bash
components/create/image-to-video-panel.tsx.backup
components/create/image-to-video-panel.tsx.bak
components/create/text-to-video-panel-new.tsx.backup
components/create/text-to-video-panel-new.tsx.bak
components/create/video-effects-panel.tsx.backup
components/create/video-effects-panel.tsx.bak
components/create/video-task-grid-item.tsx.bak
```

**理由**:
- 代码已提交到 Git，备份文件多余
- 这些文件会被 TypeScript 和构建工具扫描，影响性能
- 占用磁盘空间

---

### 🚨 Hooks 备份（应立即删除）

```bash
hooks/use-unified-polling.ts.bak
hooks/use-video-polling-v2.ts.bak
hooks/use-image-polling-v2.ts.bak
```

**理由**: 同上，Git 已保存历史版本。

---

### 🚨 Context 备份（应立即删除）

```bash
lib/contexts/video-context.tsx.bak
```

**理由**: 同上。

---

## 4️⃣ 根目录分析文档（可归档）

**可以移至 discuss/archive/ 的文档**：
```bash
COUPON_IMPLEMENTATION_GUIDE.md
STRIPE_COUPON_ANALYSIS.md
```

**理由**: 这些是优惠券功能的分析文档，如果功能已实现，可以归档。

---

## 📦 建议的清理操作

### 方案 1：完全删除（激进）

```bash
# 删除已完成任务文档
rm discuss/阶段*.md
rm discuss/紧急修复-*.md
rm discuss/视频轮询*.md
rm discuss/轮询逻辑优化方案.md
rm discuss/生产迁移计划.md
rm discuss/员工积分赠送实施方案.md

# 删除一次性脚本
rm scripts/add-*.ts
rm scripts/check-*.ts
rm scripts/batch-*.ts
rm scripts/find-*.ts
rm scripts/audit-*.ts
rm scripts/force-*.ts
rm scripts/direct-*.ts
rm scripts/manual-*.ts
rm scripts/mark-*.ts
rm scripts/recent-*.ts
rm scripts/search-*.ts
rm scripts/verify-*.ts
rm scripts/debug-*.ts
rm scripts/test-stuck-polling.sh
rm scripts/remove-debug-logs.py

# 删除临时报告
rm -rf scripts/reports/

# 删除临时数据文件
rm scripts/employees*.json

# 删除 SQL 脚本
rm scripts/sql/create_pending_credits*.sql
rm scripts/sql/insert_employee_credits_template.sql
rm scripts/sql/query_pending_credits.sql
rm scripts/sql/upgrade-*.sql

# 删除所有备份文件
rm components/create/*.backup
rm components/create/*.bak
rm hooks/*.bak
rm lib/contexts/*.bak

# 归档根目录文档
mv COUPON_IMPLEMENTATION_GUIDE.md discuss/archive/
mv STRIPE_COUPON_ANALYSIS.md discuss/archive/
```

---

### 方案 2：归档保留（保守）

```bash
# 创建归档目录
mkdir -p discuss/archive/轮询系统迁移
mkdir -p discuss/archive/积分系统
mkdir -p scripts/archive/运维脚本
mkdir -p scripts/archive/报告

# 归档轮询系统文档
mv discuss/阶段*.md discuss/archive/轮询系统迁移/
mv discuss/紧急修复-*.md discuss/archive/轮询系统迁移/
mv discuss/视频轮询*.md discuss/archive/轮询系统迁移/
mv discuss/轮询逻辑优化方案.md discuss/archive/轮询系统迁移/
mv discuss/生产迁移计划.md discuss/archive/轮询系统迁移/

# 归档积分系统文档
mv discuss/员工积分赠送实施方案.md discuss/archive/积分系统/

# 归档运维脚本
mv scripts/*.ts scripts/archive/运维脚本/ 2>/dev/null || true
mv scripts/sql/*.sql scripts/archive/运维脚本/ 2>/dev/null || true
mv scripts/*.py scripts/archive/运维脚本/ 2>/dev/null || true

# 归档报告和数据
mv scripts/reports/ scripts/archive/
mv scripts/employees*.json scripts/archive/运维脚本/

# 归档根目录文档
mv COUPON_IMPLEMENTATION_GUIDE.md discuss/archive/
mv STRIPE_COUPON_ANALYSIS.md discuss/archive/

# 删除备份文件（这些不需要归档）
rm components/create/*.backup
rm components/create/*.bak
rm hooks/*.bak
rm lib/contexts/*.bak
```

---

## ✅ 推荐清理方案

**混合方案**（删除 + 归档）：

1. **立即删除备份文件**（不需要保留）
2. **归档已完成任务文档**（可能需要回顾）
3. **归档一次性脚本**（万一需要参考）
4. **保留技术参考文档**（长期有用）

---

## 📝 清理后的目录结构

```
vidfab/
├── discuss/
│   ├── archive/                       # 归档目录
│   │   ├── 轮询系统迁移/
│   │   ├── 积分系统/
│   │   ├── COUPON_IMPLEMENTATION_GUIDE.md
│   │   └── STRIPE_COUPON_ANALYSIS.md
│   ├── 下一步优化方案.md             # 保留
│   ├── 积分系统代码快速参考.md        # 保留
│   └── 积分系统深度分析报告.md        # 保留
│
├── scripts/
│   ├── archive/                       # 归档目录
│   │   ├── 运维脚本/
│   │   └── 报告/
│   ├── *.sh                          # 保留（生产脚本）
│   └── assign-employee-credits.ts    # 保留（可能重复使用）
│
├── components/create/                # 无备份文件
├── hooks/                            # 无备份文件
└── lib/contexts/                     # 无备份文件
```

---

## 🎯 清理收益

1. **项目更整洁**: 减少 57 个过时文件
2. **构建更快**: 减少 TypeScript 扫描的文件数量
3. **认知负担更低**: 新开发者不会被过时文档迷惑
4. **仓库更小**: 减少约 500KB+ 的无用文件
5. **可维护性提升**: 清晰的文档结构

---

## ⚠️ 注意事项

1. **Git 历史保留**: 所有删除的文件仍可通过 Git 历史恢复
2. **团队确认**: 删除前与团队确认，避免误删重要文件
3. **逐步清理**: 建议先归档，观察 1-2 周后再删除
4. **保留 CLAUDE.md**: 这是项目规范，必须保留
5. **保留 README.md**: 这是项目说明，必须保留

---

## 📌 执行建议

**立即执行**（无风险）：
```bash
# 删除所有备份文件
rm components/create/*.backup components/create/*.bak
rm hooks/*.bak
rm lib/contexts/*.bak
```

**谨慎执行**（需要团队确认）：
```bash
# 使用方案 2 的归档命令
# 观察 1-2 周后，再决定是否删除 archive/ 目录
```

---

**文档结束**
